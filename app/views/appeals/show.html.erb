<div class="appeal">
  
  <div class="grid12 lone title clearfix">
    <%= content_tag :h1, @appeal.title, :style=>"float:left" %>
    <%= content_tag :h2, " - #{@appeal.subtitle}", :class=>"subtitle", :style=>"float:left;padding: 2px 10px;" %>
  </div>
    
  <div class="grid8 first">  
    
    <div class="picture border fullshadow">
      <div class="therfmometer">
        <div class="barf"></div>
      </div>
      
      <%= image_tag @appeal.photo.url(:featured) %>
    </div>
  
    <div class="figures grid8 lone">
      <h2 class="grid2 first">
        <%= "#{(((4000-1256.70)/4000)*100).floor}%" %><span class="keyword"> Funded</span>
      </h2>
      <h2 class="grid3" style="text-align: center;">
        $1256.70 <span class="keyword">Raised</span>
      </h2>
      <h2 class="grid3 last" style="text-align:right">
        365 Days <span class="keyword">Remaining</span>
      </h2>
    </div>
    
    <p class="bigger grid8 lone" style="">
     <%= @appeal.description %>
    </p>
    
    
    <div class="supporters grid8 lone">
      <h2>4 Supporters</h2>
      <div id="slider">
        <div class="slide supporter">
          <%= image_tag "profile.png" %>
          <p>
            <strong>Louise Buffoon</strong><br />
            <span class="secondary">
            donated $5
            </span>
          </p>
        </div>
        <div class="slide supporter">
          <%= image_tag "profile.png" %>
          <p>
            <strong>Franklin Charles</strong><br />
            <span class="secondary">
            donated $40
            </span>
          </p>
        </div>
        <div class="slide supporter">
          <%= image_tag "profile.png" %>
          <p>
            <strong>Rose Urgopod</strong><br />
            <span class="secondary">
            donated $25
            </span>
          </p>
        </div>
        <div class="slide supporter">
          <%= image_tag "profile.png" %>
          <p>
            <strong>Celine Dion</strong><br />
            <span class="secondary">
            donated $250
            </span>
          </p>
        </div>
      </div>
    </div>
    
    <div class="comments grid8 lone">
      <h2>Comments</h2>
    </div>
  </div>

  <div class="grid4 last">
    <% @appeal.rewards.order(:amount).each_with_index do |reward, i| %>
    <% klass = "package clearfix ";
        klass += "top" if (i.eql? 0);
        klass += "bottom"  if (i.eql? @appeal.rewards.count-1) %>
      <div class="<%= klass %>" title="Choose This Reward">
        <h2>
          Donate <%= number_to_currency reward.amount %> or more
          <%= image_tag "add_to_cart_dark.png", :style=>"float: right;height: 40px;display:none"%>
        </h2>
        <p class="secondary">
          X supporters
          <% if reward.limit %>
            &nbsp;|&nbsp;
            <%= reward.limit %> rewards remaining
          <% end %>
        </p>
        <%= content_tag :p, reward.description %>
      </div>
    <% end %>
  </div>

</div>


<% content_for(:deferred_scripts) do %>
  <%= javascript_include_tag "mylibs/jquery.bxSlider.min.js" %>
<% end %>

<% content_for(:jquery) do %>
  $(".bar").animate(function(){
    height: '+60%'
    }, 1000);
    
  $(".package").hover(function(){
    if(!$(this).data("incart")){
      $(this).find("img").toggle(); 
    }
  });
  
  $(".package").click(function() {
    $(this).toggleClass("selected");
    
    var counter = $("#count p");
    
    var count = parseInt(counter.html());
    if(isNaN(count)){
      count = 0;
    }
    
    if(!$(this).data("incart")){
      count++;
      
      $(this).find("img").attr("src", "/images/in_cart.png").show();
      $(this).attr("title", "Remove this reward from your cart");
      $(this).data("incart", true);
    }else{
      $(this).find("img").attr("src", "/images/add_to_cart_dark.png");
      $(this).attr("title", "Choose this reward");
      count--;
      $(this).data("incart", false);
    }
    if(count > 0){
      $(".checkout").fadeIn();
      $("#count").clearQueue().stop();
      counter.html(count);
      $("#count").effect("bounce", { times:3, distance:10 }, 300, function(){console.log($(this).attr("style","position:absolute;"))})
    }else{  
      counter.html(count);
    }
  });
  
  $('#slider').bxSlider({
    auto: true,
    displaySlideQty: 3
  });
<% end %>